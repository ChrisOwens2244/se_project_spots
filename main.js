!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",errorSelector:".modal__error",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visiable"};function r(e,t,r){!function(e){return e.some((e=>!e.validity.valid))}(e)?(t.disabled=!1,t.classList.remove(r.inactiveButtonClass)):(t.disabled=!0,t.classList.add(r.inactiveButtonClass))}function n(e,t){e.disabled=!0,e.classList.add(t.inactiveButtonClass)}var o=e+"8650253b58b46f0f1c06.svg",a=e+"1ecf96fab54a91c898b4.svg",s=e+"40608da7369d39bc1077.svg",c=e+"d73f076c46eb5467f5fc.svg";function d(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";t.textContent=e?n:r}function i(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.preventDefault();const n=t.submitter,o=n.textContent;d(!0,n,o,r),e().then((()=>{t.target.reset()})).catch(console.error).finally((()=>{d(!1,n,o)}))}const l=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getAppInfo(){return Promise.all([this.getInitalCards(),this.getUserInfo()])}getInitalCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResopnse)}makeCard(e){let{link:t,name:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({link:t,name:r})}).then(this._checkResopnse)}deleteCard(e){let{id:t}=e;return fetch(`${this._baseUrl}/cards/${t}`,{method:"DELETE",headers:this._headers}).then(this._checkResopnse)}changeLikeStatus(e){let{id:t,isLiked:r}=e;return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:r?"DELETE":"PUT",headers:this._headers}).then(this._checkResopnse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResopnse)}updateProfileInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then(this._checkResopnse)}updateAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResopnse)}_checkResopnse(e){if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"d11d0e4f-579c-4c1f-9935-38514d3f14dc","Content-Type":"application/json"}}),u=document.getElementById("image-logo"),m=document.getElementById("image-avatar"),h=document.getElementById("image-pen"),_=document.getElementById("image-pen-white"),f=document.getElementById("image-plus");u.src=o,h.src=a,_.src=c,f.src=s;const v=document.querySelector(".profile__edit-btn"),p=document.querySelector("#edit-modal"),y=document.querySelector("#photo-modal"),S=y.querySelector(".modal__photo"),b=y.querySelector(".modal__description"),g=document.forms["edit-profile"],E=g.querySelector(".modal__save-button"),k=g.querySelector("#name"),q=g.querySelector("#description"),L=document.querySelector(".profile__name"),C=document.querySelector(".profile__description");function $(e){e.classList.add("modal_opened"),document.addEventListener("keydown",U)}function I(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",U)}function U(e){"Escape"===e.key&&I(document.querySelector(".modal_opened"))}l.getAppInfo().then((e=>{const t=e[0],r=e[1];m.src=r.avatar,m.alt=r.name,L.textContent=r.name,C.textContent=r.about,t.forEach((e=>{const t=R(e);x.append(t)}))})).catch((e=>{console.error(e)})),document.querySelectorAll(".modal").forEach((e=>{e.addEventListener("click",(function(t){t.target.classList.contains("modal")&&I(e)}))})),document.querySelectorAll(".modal__close-button").forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(e=>{I(t)}))})),v.addEventListener("click",(()=>{$(p),k.value=L.textContent,q.value=C.textContent,n(E,t)})),g.addEventListener("submit",(function(e){i((function(){return l.updateProfileInfo({name:k.value,about:q.value}).then((e=>{L.textContent=e.name,C.textContent=e.about,I(p)})).catch((e=>console.error(e)))}),e)}));const x=document.querySelector(".cards__list"),A=document.querySelector("#card");let B,P;function R(e){const t=A.content.cloneNode(!0),r=t.querySelector(".card__button"),n=t.querySelector(".card__delete-button"),o=e.link,a=e.name,s=t.querySelector(".card__image");return s.src=o,s.alt=a,t.querySelector(".card__name").textContent=a,n.addEventListener("click",(t=>{!function(e,t){B=e.target.closest(".card"),P=t,$(F)}(t,e._id)})),e.isLiked&&r.classList.add("card__button_liked"),r.addEventListener("click",(t=>{!function(e,t){const r=e.target.classList.contains("card__button_liked");l.changeLikeStatus({id:t,isLiked:r}).then((()=>{e.target.classList.toggle("card__button_liked")})).catch((e=>{console.error(e)}))}(t,e._id)})),s.addEventListener("click",(()=>{S.src=o,S.alt=a,b.textContent=a,$(y)})),t}const T=document.querySelector(".profile__new-btn"),w=document.querySelector("#add-modal"),D=document.forms["add-post"],N=D.querySelector(".modal__save-button"),O=D.querySelector("#link"),j=D.querySelector("#caption");T.addEventListener("click",(()=>{$(w),n(N,t)})),D.addEventListener("submit",(function(e){i((function(){return l.makeCard({link:O.value,name:j.value}).then((e=>{x.prepend(R(e)),I(w)})).catch((e=>console.error(e)))}),e)}));const J=document.querySelector("#avatar-modal"),H=document.forms["avatar-form"],z=H.querySelector(".modal__save-button"),M=H.querySelector("#avatar-pic");document.querySelector(".profile__avatar-btn").addEventListener("click",(()=>{$(J),n(z,t)})),H.addEventListener("submit",(function(e){i((function(){return l.updateAvatar({avatar:M.value}).then((e=>{m.src=e.avatar,I(J)})).catch((e=>{console.error(e)}))}),e)}));const F=document.querySelector("#delete-modal"),G=F.querySelector(".modal__prompt-buttons");var K;G.querySelector(".modal__delete-button"),G.addEventListener("submit",(function(e){i((function(){return l.deleteCard({id:P}).then((()=>{B.remove(),I(F)})).catch((e=>{console.error(e)}))}),e,"Deleting...")})),K=t,Array.from(document.querySelectorAll(K.formSelector)).forEach((e=>{e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){const n=e.querySelector(t.submitButtonSelector),o=Array.from(e.querySelectorAll(t.inputSelector));r(o,n,t),o.forEach((a=>{a.addEventListener("input",(function(){!function(e,t,r){t.validity.valid?function(e,t,r){const n=e.querySelector(`${r.errorSelector}-${t.id}`);t.classList.remove(r.inputErrorClass),n.classList.remove(r.errorClass),n.textContent=""}(e,t,r):function(e,t,r,n){const o=e.querySelector(`${r.errorSelector}-${t.id}`);t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(e,t,r,t.validationMessage)}(e,a,t),r(o,n,t)}))}))}(e,K)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVNDLE1BVjdCLFNBQXdCd0osRUFBYTFKLEVBQWNGLEdBQ2pELE1BQU02SixFQUFlRCxFQUFZcEUsY0FDL0IsR0FBR3hGLEVBQU9QLGlCQUFpQlMsRUFBYXlELE1BRTFDekQsRUFBYUssVUFBVUMsT0FBT1IsRUFBT0wsaUJBQ3JDa0ssRUFBYXRKLFVBQVVDLE9BQU9SLEVBQU9KLFlBQ3JDaUssRUFBYTFJLFlBQWMsRUFDN0IsQ0FXSTJJLENBQWVGLEVBQWExSixFQUFjRixHQTNCOUMsU0FBd0I0SixFQUFhMUosRUFBY0YsRUFBUStKLEdBQ3pELE1BQU1GLEVBQWVELEVBQVlwRSxjQUMvQixHQUFHeEYsRUFBT1AsaUJBQWlCUyxFQUFheUQsTUFFMUN6RCxFQUFhSyxVQUFVRSxJQUFJVCxFQUFPTCxpQkFDbENrSyxFQUFhMUksWUFBYzRJLEVBQzNCRixFQUFhdEosVUFBVUUsSUFBSVQsRUFBT0osV0FDcEMsQ0FhSW9LLENBQ0VKLEVBQ0ExSixFQUNBRixFQUNBRSxFQUFhK0osa0JBS25CLENBNEJNQyxDQUFtQk4sRUFBYTFKLEVBQWNGLEdBQzlDSCxFQUFrQkMsRUFBV0MsRUFBZUMsRUFDOUMsR0FBRSxHQUVOLENBUUltSyxDQUFrQlIsRUFBUTNKLEVBQU8sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiLy8gRGVjbGFyaW5nIGEgY29uZmlndXJhdGlvbiBvYmplY3QgdGhhdCBjb250YWlucyB0aGVcbi8vIG5lY2Vzc2FyeSBjbGFzc2VzIGFuZCBzZWxlY3RvcnMuXG5jb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiLFxuICBlcnJvclNlbGVjdG9yOiBcIi5tb2RhbF9fZXJyb3JcIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc2F2ZS1idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2lhYmxlXCIsXG59O1xuXG5mdW5jdGlvbiBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcsIG1lc3NhZ2UpIHtcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICBgJHtjb25maWcuZXJyb3JTZWxlY3Rvcn0tJHtpbnB1dEVsZW1lbnQuaWR9YFxuICApO1xuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gbWVzc2FnZTtcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmVycm9yQ2xhc3MpO1xufVxuXG5mdW5jdGlvbiBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpIHtcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICBgJHtjb25maWcuZXJyb3JTZWxlY3Rvcn0tJHtpbnB1dEVsZW1lbnQuaWR9YFxuICApO1xuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmVycm9yQ2xhc3MpO1xuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xufVxuXG5mdW5jdGlvbiBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSB7XG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoXG4gICAgICBmb3JtRWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudCxcbiAgICAgIGNvbmZpZyxcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZVxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9IGVsc2Uge1xuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBjb25maWcpIHtcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxuICApO1xuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGVuYWJsZVZhbGlkYXRpb24oY29uZmlnKSB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XG4gICAgZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsLCBjb25maWcpO1xuICB9KTtcbn1cbmZ1bmN0aW9uIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKSB7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xufVxuXG4vL2VuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuZXhwb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiwgZGlzYWJsZUJ1dHRvbiwgc2V0dGluZ3MgfTtcbiIsImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICBnZXRBcHBJbmZvKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0YWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcbiAgfVxuXG4gIGdldEluaXRhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc29wbnNlKTtcbiAgfVxuXG4gIG1ha2VDYXJkKHsgbGluaywgbmFtZSB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGxpbmssIG5hbWUgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc29wbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoeyBpZCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzb3Buc2UpO1xuICB9XG5cbiAgY2hhbmdlTGlrZVN0YXR1cyh7IGlkLCBpc0xpa2VkIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc29wbnNlKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc29wbnNlKTtcbiAgfVxuXG4gIHVwZGF0ZVByb2ZpbGVJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzb3Buc2UpO1xuICB9XG5cbiAgdXBkYXRlQXZhdGFyKHsgYXZhdGFyIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXIgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc29wbnNlKTtcbiAgfVxuICBfY2hlY2tSZXNvcG5zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cbn1cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiIsIi8vIGRlZmluZSBhIGZ1bmN0aW9uIGZvciBjaGFuZ2luZyB0aGUgYnV0dG9uIHRleHQuIEl0IGFjY2VwdHMgNCBwYXJhbXMgKHRoZSAyIGxhc3QgYXJlIG9wdGlvbmFsIHdpdGggZGVmYXVsdCB0ZXh0cylcbmZ1bmN0aW9uIHJlbmRlckxvYWRpbmcoXG4gIGlzTG9hZGluZyxcbiAgYnV0dG9uLFxuICBidXR0b25UZXh0ID0gXCJTYXZlXCIsXG4gIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIlxuKSB7XG4gIGlmIChpc0xvYWRpbmcpIHtcbiAgICBidXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgfSBlbHNlIHtcbiAgICBidXR0b24udGV4dENvbnRlbnQgPSBidXR0b25UZXh0O1xuICB9XG59XG5cbi8vIGRlZmluZSBhIHVuaXZlcnNhbCBmdW5jdGlvbiB0aGF0IGFjY2VwdHMgYSByZXF1ZXN0IGZ1bmN0aW9uLCBldmVudCBhbmQgYSBkZWZhdWx0IGxvYWRpbmcgdGV4dFxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZVN1Ym1pdChyZXF1ZXN0LCBldnQsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAvLyBZb3UgbmVlZCB0byBwcmV2ZW50IHRoZSBkZWZhdWx0IGFjdGlvbiBpbiBhbnkgc3VibWl0IGhhbmRsZXJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgLy8gdGhlIGJ1dHRvbiBpcyBhbHdheXMgYXZhaWxhYmxlIGluc2lkZSBgZXZlbnRgIGFzIGBzdWJtaXR0ZXJgXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGV2dC5zdWJtaXR0ZXI7XG4gIC8vIGZpeCB0aGUgaW5pdGlhbCBidXR0b24gdGV4dFxuICBjb25zdCBpbml0aWFsVGV4dCA9IHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgLy8gY2hhbmdlIHRoZSBidXR0b24gdGV4dCBiZWZvcmUgcmVxdWVzdGluZ1xuICByZW5kZXJMb2FkaW5nKHRydWUsIHN1Ym1pdEJ1dHRvbiwgaW5pdGlhbFRleHQsIGxvYWRpbmdUZXh0KTtcbiAgLy8gY2FsbCB0aGUgcmVxdWVzdCBmdW5jdGlvbiB0byBiZSBhYmxlIHRvIHVzZSB0aGUgcHJvbWlzZSBjaGFpblxuICByZXF1ZXN0KClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICAvLyBhbnkgZm9ybSBzaG91bGQgYmUgcmVzZXQgYWZ0ZXIgYSBzdWNjZXNzZnVsIHJlc3BvbnNlXG4gICAgICAvLyBldnQudGFyZ2V0IGlzIHRoZSBmb3JtIGluIGFueSBzdWJtaXQgaGFuZGxlclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xuICAgIH0pXG4gICAgLy8gd2UgbmVlZCB0byBjYXRjaCBwb3NzaWJsZSBlcnJvcnNcbiAgICAvLyBjb25zb2xlLmVycm9yIGlzIHVzZWQgdG8gaGFuZGxlIGVycm9ycyBpZiB5b3UgZG9u4oCZdCBoYXZlIGFueSBvdGhlciB3YXlzIGZvciB0aGF0XG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG5cbiAgICAvLyBhbmQgaW4gZmluYWxseSB3ZSBuZWVkIHRvIHN0b3AgbG9hZGluZ1xuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIHN1Ym1pdEJ1dHRvbiwgaW5pdGlhbFRleHQpO1xuICAgIH0pO1xufVxuIiwiaW1wb3J0IHtcbiAgZW5hYmxlVmFsaWRhdGlvbixcbiAgZGlzYWJsZUJ1dHRvbixcbiAgc2V0dGluZ3MsXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG4vL2ltcG9ydCBpbml0aWFsQ2FyZHMgZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XG5cbmltcG9ydCBsb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvTG9nby5zdmdcIjtcbi8vaW1wb3J0IGF2YXRhclNyYyBmcm9tIFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcbmltcG9ydCBwZW5TcmMgZnJvbSBcIi4uL2ltYWdlcy9wZW4uc3ZnXCI7XG5pbXBvcnQgcGx1c1NyYyBmcm9tIFwiLi4vaW1hZ2VzL3BsdXMuc3ZnXCI7XG5pbXBvcnQgcGVuV2hpdGVTcmMgZnJvbSBcIi4uL2ltYWdlcy9wZW4td2hpdGUuc3ZnXCI7XG5pbXBvcnQgeyBoYW5kbGVTdWJtaXQgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiZDExZDBlNGYtNTc5Yy00YzFmLTk5MzUtMzg1MTRkM2YxNGRjXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuY29uc3QgaW1hZ2VMb2dvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbWFnZS1sb2dvXCIpO1xuY29uc3QgaW1hZ2VBdmF0YXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlLWF2YXRhclwiKTtcbmNvbnN0IGltYWdlUGVuQmxhY2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlLXBlblwiKTtcbmNvbnN0IGltYWdlUGVuV2hpdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlLXBlbi13aGl0ZVwiKTtcbmNvbnN0IGltYWdlUGx1cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW1hZ2UtcGx1c1wiKTtcblxuaW1hZ2VMb2dvLnNyYyA9IGxvZ29TcmM7XG5pbWFnZVBlbkJsYWNrLnNyYyA9IHBlblNyYztcbmltYWdlUGVuV2hpdGUuc3JjID0gcGVuV2hpdGVTcmM7XG5pbWFnZVBsdXMuc3JjID0gcGx1c1NyYztcblxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xuY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsXCIpO1xuXG5jb25zdCBwaG90b01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwaG90by1tb2RhbFwiKTtcbmNvbnN0IHBob3RvTW9kYWxJbWFnZSA9IHBob3RvTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcGhvdG9cIik7XG5jb25zdCBwaG90b01vZGFsQ2FwdGlvbiA9IHBob3RvTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZGVzY3JpcHRpb25cIik7XG5cbmNvbnN0IHByb2ZpbGVGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1wcm9maWxlXCJdO1xuY29uc3QgcHJvZmlsZVNhdmVCdG4gPSBwcm9maWxlRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZS1idXR0b25cIik7XG5cbmNvbnN0IG5hbWVJbnB1dCA9IHByb2ZpbGVGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI25hbWVcIik7XG5jb25zdCBqb2JJbnB1dCA9IHByb2ZpbGVGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2Rlc2NyaXB0aW9uXCIpO1xuXG5jb25zdCBwcm9maWxlTmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlSm9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5cbmFwaVxuICAuZ2V0QXBwSW5mbygpXG4gIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICBjb25zdCBzYXZlZENhcmRzID0gcmVzdWx0WzBdO1xuICAgIGNvbnN0IHNhdmVkUHJvZmlsZSA9IHJlc3VsdFsxXTtcbiAgICBpbWFnZUF2YXRhci5zcmMgPSBzYXZlZFByb2ZpbGVbXCJhdmF0YXJcIl07XG4gICAgaW1hZ2VBdmF0YXIuYWx0ID0gc2F2ZWRQcm9maWxlW1wibmFtZVwiXTtcbiAgICBwcm9maWxlTmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBzYXZlZFByb2ZpbGVbXCJuYW1lXCJdO1xuICAgIHByb2ZpbGVKb2JFbGVtZW50LnRleHRDb250ZW50ID0gc2F2ZWRQcm9maWxlW1wiYWJvdXRcIl07XG4gICAgc2F2ZWRDYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWwgPSBnZXRDYXJkRWxlbWVudHMoY2FyZCk7XG4gICAgICBjYXJkc0xpc3QuYXBwZW5kKGNhcmRFbCk7XG4gICAgfSk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9KTtcblxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGVzY2FwZUxpc3RlbmVyKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBlc2NhcGVMaXN0ZW5lcik7XG59XG5cbmZ1bmN0aW9uIGVzY2FwZUxpc3RlbmVyKGV2dCkge1xuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4gICAgY2xvc2VNb2RhbChtb2RhbCk7XG4gIH1cbn1cblxuY29uc3QgbW9kYWxMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcbm1vZGFsTGlzdC5mb3JFYWNoKChtb2RhbCkgPT4ge1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2dCkge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XG4gICAgICBjbG9zZU1vZGFsKG1vZGFsKTtcbiAgICB9XG4gIH0pO1xufSk7XG5cbmNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcbmNsb3NlQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgY29uc3QgcG9wdXAgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgY2xvc2VNb2RhbChwb3B1cCk7XG4gIH0pO1xufSk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xuXG4gIG5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lRWxlbWVudC50ZXh0Q29udGVudDtcbiAgam9iSW5wdXQudmFsdWUgPSBwcm9maWxlSm9iRWxlbWVudC50ZXh0Q29udGVudDtcblxuICBkaXNhYmxlQnV0dG9uKHByb2ZpbGVTYXZlQnRuLCBzZXR0aW5ncyk7XG59KTtcblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZXZ0KSB7XG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgIHJldHVybiBhcGlcbiAgICAgIC51cGRhdGVQcm9maWxlSW5mbyh7IG5hbWU6IG5hbWVJbnB1dC52YWx1ZSwgYWJvdXQ6IGpvYklucHV0LnZhbHVlIH0pXG4gICAgICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICAgICAgcHJvZmlsZU5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gdXNlckRhdGFbXCJuYW1lXCJdO1xuICAgICAgICBwcm9maWxlSm9iRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEYXRhW1wiYWJvdXRcIl07XG4gICAgICAgIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcbiAgfVxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGV2dCk7XG59XG5cbi8vIENvbm5lY3QgdGhlIGhhbmRsZXIgdG8gdGhlIGZvcm0sIHNvIGl0IHdpbGwgd2F0Y2ggZm9yIHRoZSBzdWJtaXQgZXZlbnQuXG5wcm9maWxlRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XG5cbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmRcIik7XG5cbmxldCBzZWxlY3RlZENhcmQ7XG5sZXQgc2VsZWN0ZWRDYXJkSWQ7XG5cbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50cyhkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpO1xuICBjb25zdCBsaWtlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19idXR0b25cIik7XG4gIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcblxuICBjb25zdCBjYXJkSW1hZ2UgPSBkYXRhW1wibGlua1wiXTtcbiAgY29uc3QgY2FyZE5hbWUgPSBkYXRhW1wibmFtZVwiXTtcbiAgY29uc3QgY2FyZEltYWdlRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG5cbiAgY2FyZEltYWdlRWxlbWVudC5zcmMgPSBjYXJkSW1hZ2U7XG4gIGNhcmRJbWFnZUVsZW1lbnQuYWx0ID0gY2FyZE5hbWU7XG4gIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbmFtZVwiKS50ZXh0Q29udGVudCA9IGNhcmROYW1lO1xuXG4gIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgIGhhbmRsZURlbGV0ZUNhcmQoZXZ0LCBkYXRhW1wiX2lkXCJdKTtcbiAgfSk7XG5cbiAgaWYgKGRhdGEuaXNMaWtlZCkge1xuICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2J1dHRvbl9saWtlZFwiKTtcbiAgfVxuXG4gIGxpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICBoYW5kbGVMaWtlKGV2dCwgZGF0YVtcIl9pZFwiXSk7XG4gIH0pO1xuXG4gIGNhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBwaG90b01vZGFsSW1hZ2Uuc3JjID0gY2FyZEltYWdlO1xuICAgIHBob3RvTW9kYWxJbWFnZS5hbHQgPSBjYXJkTmFtZTtcbiAgICBwaG90b01vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IGNhcmROYW1lO1xuICAgIG9wZW5Nb2RhbChwaG90b01vZGFsKTtcbiAgfSk7XG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxuY29uc3QgcG9zdEFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmV3LWJ0blwiKTtcbmNvbnN0IGFkZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtbW9kYWxcIik7XG5cbmNvbnN0IHBvc3RGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLXBvc3RcIl07XG5jb25zdCBwb3N0U2F2ZUJ0biA9IHBvc3RGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiKTtcblxuY29uc3QgbGlua0lucHV0ID0gcG9zdEZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbGlua1wiKTtcbmNvbnN0IGNhcHRpb25JbnB1dCA9IHBvc3RGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcHRpb25cIik7XG5cbnBvc3RBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3Blbk1vZGFsKGFkZE1vZGFsKTtcbiAgZGlzYWJsZUJ1dHRvbihwb3N0U2F2ZUJ0biwgc2V0dGluZ3MpO1xufSk7XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZEZvcm1TdWJtaXQoZXZ0KSB7XG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgIHJldHVybiBhcGlcbiAgICAgIC5tYWtlQ2FyZCh7IGxpbms6IGxpbmtJbnB1dC52YWx1ZSwgbmFtZTogY2FwdGlvbklucHV0LnZhbHVlIH0pXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICBjYXJkc0xpc3QucHJlcGVuZChnZXRDYXJkRWxlbWVudHMoZGF0YSkpO1xuICAgICAgICBjbG9zZU1vZGFsKGFkZE1vZGFsKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcbiAgfVxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGV2dCk7XG59XG5wb3N0Rm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRGb3JtU3VibWl0KTtcblxuY29uc3QgZWRpdEF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XG5jb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJhdmF0YXItZm9ybVwiXTtcbmNvbnN0IGF2YXRhclNhdmVCdG4gPSBhdmF0YXJGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIpO1xuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLXBpY1wiKTtcbmNvbnN0IGF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcblxuYXZhdGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChlZGl0QXZhdGFyTW9kYWwpO1xuICBkaXNhYmxlQnV0dG9uKGF2YXRhclNhdmVCdG4sIHNldHRpbmdzKTtcbn0pO1xuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWJtaXQoZXZ0KSB7XG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgIHJldHVybiBhcGlcbiAgICAgIC51cGRhdGVBdmF0YXIoeyBhdmF0YXI6IGF2YXRhcklucHV0LnZhbHVlIH0pXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICBpbWFnZUF2YXRhci5zcmMgPSBkYXRhW1wiYXZhdGFyXCJdO1xuICAgICAgICBjbG9zZU1vZGFsKGVkaXRBdmF0YXJNb2RhbCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH1cbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBldnQpO1xufVxuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsXCIpO1xuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3Byb21wdC1idXR0b25zXCIpO1xuY29uc3QgZGVsZXRlQnV0dG9uID0gZGVsZXRlRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19kZWxldGUtYnV0dG9uXCIpO1xuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGV2dCwgaWQpIHtcbiAgc2VsZWN0ZWRDYXJkID0gZXZ0LnRhcmdldC5jbG9zZXN0KFwiLmNhcmRcIik7XG4gIHNlbGVjdGVkQ2FyZElkID0gaWQ7XG4gIC8vY29uc29sZS5sb2coc2VsZWN0ZWRDYXJkSWQpO1xuICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoZXZ0KSB7XG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgIHJldHVybiBhcGlcbiAgICAgIC5kZWxldGVDYXJkKHsgaWQ6IHNlbGVjdGVkQ2FyZElkIH0pXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcbiAgICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH1cbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBldnQsIFwiRGVsZXRpbmcuLi5cIik7XG59XG5cbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xuXG5mdW5jdGlvbiBoYW5kbGVMaWtlKGV2dCwgaWQpIHtcbiAgY29uc3QgbGlrZWQgPSBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2J1dHRvbl9saWtlZFwiKTtcbiAgYXBpXG4gICAgLmNoYW5nZUxpa2VTdGF0dXMoeyBpZDogaWQsIGlzTGlrZWQ6IGxpa2VkIH0pXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fYnV0dG9uX2xpa2VkXCIpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KTtcbn1cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImVycm9yU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWxlbWVudCIsImNvbmZpZyIsInNvbWUiLCJpbnB1dEVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJkaXNhYmxlQnV0dG9uIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImJ1dHRvbiIsImJ1dHRvblRleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJsb2FkaW5nVGV4dCIsInRleHRDb250ZW50IiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0QnV0dG9uIiwic3VibWl0dGVyIiwiaW5pdGlhbFRleHQiLCJ0aGVuIiwidGFyZ2V0IiwicmVzZXQiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImZpbmFsbHkiLCJhcGkiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiZ2V0QXBwSW5mbyIsIlByb21pc2UiLCJhbGwiLCJnZXRJbml0YWxDYXJkcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJfY2hlY2tSZXNvcG5zZSIsIm1ha2VDYXJkIiwiX3JlZiIsImxpbmsiLCJuYW1lIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZWxldGVDYXJkIiwiX3JlZjIiLCJpZCIsImNoYW5nZUxpa2VTdGF0dXMiLCJfcmVmMyIsImlzTGlrZWQiLCJ1cGRhdGVQcm9maWxlSW5mbyIsIl9yZWY0IiwiYWJvdXQiLCJ1cGRhdGVBdmF0YXIiLCJfcmVmNSIsImF2YXRhciIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImF1dGhvcml6YXRpb24iLCJpbWFnZUxvZ28iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW1hZ2VBdmF0YXIiLCJpbWFnZVBlbkJsYWNrIiwiaW1hZ2VQZW5XaGl0ZSIsImltYWdlUGx1cyIsInNyYyIsImxvZ29TcmMiLCJwZW5TcmMiLCJwZW5XaGl0ZVNyYyIsInBsdXNTcmMiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3IiLCJlZGl0TW9kYWwiLCJwaG90b01vZGFsIiwicGhvdG9Nb2RhbEltYWdlIiwicGhvdG9Nb2RhbENhcHRpb24iLCJwcm9maWxlRm9ybUVsZW1lbnQiLCJmb3JtcyIsInByb2ZpbGVTYXZlQnRuIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJwcm9maWxlTmFtZUVsZW1lbnQiLCJwcm9maWxlSm9iRWxlbWVudCIsIm9wZW5Nb2RhbCIsIm1vZGFsIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVzY2FwZUxpc3RlbmVyIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJyZXN1bHQiLCJzYXZlZENhcmRzIiwic2F2ZWRQcm9maWxlIiwiYWx0IiwiZm9yRWFjaCIsImNhcmQiLCJjYXJkRWwiLCJnZXRDYXJkRWxlbWVudHMiLCJjYXJkc0xpc3QiLCJhcHBlbmQiLCJlcnIiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY29udGFpbnMiLCJwb3B1cCIsImNsb3Nlc3QiLCJ2YWx1ZSIsInVzZXJEYXRhIiwiY2FyZFRlbXBsYXRlIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJkYXRhIiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwibGlrZUJ1dHRvbiIsImRlbGV0ZUJ1dHRvbiIsImNhcmRJbWFnZSIsImNhcmROYW1lIiwiY2FyZEltYWdlRWxlbWVudCIsImRlbGV0ZU1vZGFsIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImxpa2VkIiwidG9nZ2xlIiwiaGFuZGxlTGlrZSIsInBvc3RBZGRCdXR0b24iLCJhZGRNb2RhbCIsInBvc3RGb3JtRWxlbWVudCIsInBvc3RTYXZlQnRuIiwibGlua0lucHV0IiwiY2FwdGlvbklucHV0IiwicHJlcGVuZCIsImVkaXRBdmF0YXJNb2RhbCIsImF2YXRhckZvcm0iLCJhdmF0YXJTYXZlQnRuIiwiYXZhdGFySW5wdXQiLCJkZWxldGVGb3JtIiwiQXJyYXkiLCJmcm9tIiwiZm9ybUVsIiwiZm9ybUVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJoaWRlSW5wdXRFcnJvciIsIm1lc3NhZ2UiLCJzaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiXSwic291cmNlUm9vdCI6IiJ9